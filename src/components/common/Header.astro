---
import { siteConfig } from '../../config/site';
import Logo from './Logo.astro';

const currentPath = Astro.url.pathname;
---

<header class="header py-6" x-data="{ mobileMenuOpen: false }">
  <div class="container">
    <nav class="flex items-center justify-between">
      <!-- Logo -->
      <a href="/" class="z-10">
        <Logo />
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center gap-10">
        {siteConfig.navigation.map((item) => (
          <a
            href={item.href}
            class:list={[
              'text-sm transition-colors duration-300',
              currentPath === item.href
                ? 'text-text'
                : 'text-text-light hover:text-text',
            ]}
          >
            {item.name}
          </a>
        ))}
      </div>

      <!-- Mobile Menu Button -->
      <button
        type="button"
        class="lg:hidden p-2 text-text z-10"
        @click="mobileMenuOpen = !mobileMenuOpen"
        :aria-expanded="mobileMenuOpen"
        aria-label="Menu"
      >
        <svg
          x-show="!mobileMenuOpen"
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
        <svg
          x-show="mobileMenuOpen"
          x-cloak
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </nav>
  </div>

  <!-- Mobile Menu (P0 Gemini fix: fixed fullscreen + bg opaque + z-50) -->
  <div
    class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-bg lg:hidden"
    x-show="mobileMenuOpen"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click.away="mobileMenuOpen = false"
  >
    <div class="flex flex-col items-center justify-center gap-8 p-8">
      {siteConfig.navigation.map((item) => (
        <a
          href={item.href}
          class:list={[
            'text-xl font-heading transition-colors',
            currentPath === item.href ? 'text-text' : 'text-text-light hover:text-text',
          ]}
          @click="mobileMenuOpen = false"
        >
          {item.name}
        </a>
      ))}
    </div>
  </div>
</header>

<style>
  [x-cloak] {
    display: none !important;
  }
</style>
